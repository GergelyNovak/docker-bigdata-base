#!/bin/bash
set -e
set -x
export CONSUL_LOCATION=172.17.0.1:8500
export CONFIG_SERVER_URL=http://172.17.0.1:8888
export RUNTIME_ENV=dev
source /usr/hdp/hadoop-configurator.sh
wget $CONFIG_SERVER_URL/core_site-$RUNTIME_ENV.properties -O /tmp/core_site.properties
wounderscore /tmp/core_site.properties
prop-to-xml /tmp/core-site.properties
/usr/bin/consul-template -once -consul $CONSUL_LOCATION -template /tmp/core-site.xml:/usr/hdp/hadoop/etc/hadoop/core-site.xml
#/usr/hdp/hadoop/bin/hdfs datanode
